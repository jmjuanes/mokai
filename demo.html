<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no">
        <title>Mokai Demo</title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:wght@700&display=swap">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;700&display=swap">
        <link rel="stylesheet" href="https://unpkg.com/lowcss/low.css">
        <link rel="stylesheet" href="https://unpkg.com/lowcss-forms/index.css">
        <link rel="stylesheet" href="./styles.css">
        <link rel="stylesheet" href="./packages/mokai-themes/styles.css">
    </head>
    <body class="m-0 font-sans text-gray-900 leading-normal">
        <!-- Main content -->
        <div class="main w-full max-w-4xl mx-auto px-6">
            <!-- Hero section -->
            <div class="w-full pt-6 pb-6">
                <div class="text-4xl font-bold font-plex-serif tracking-tight">
                    <strong>Demo</strong>
                </div>
            </div>
            <div class="w-full">
                <!-- Demo options -->
                <div class="rounded-lg bg-gray-100 p-4 grid grid-cols-1 md:grid-cols-2 mb-4 gap-4 select-none">
                    <div class="">
                        <div class="font-bold mb-1">Language:</div>
                        <select class="w-full bg-white rounded-md border-0" id="select-language">
                            <option value="javascript">JavaScript</option>
                            <option value="html">HTML</option>
                            <option value="css">CSS</option>
                            <option value="markdown">MarkDown</option>
                            <option value="json">JSON</option>
                        </select>
                    </div>
                    <div class="">
                        <div class="font-bold mb-1">Theme</div>
                        <select class="w-full bg-white rounded-md border-0" id="select-theme">
                            <option value="dark">Dark (mokai-dark)</option>
                            <option value="light">Light (mokai-light)</option>
                            <option value="monoblue">Mono Blue (mokai-monoblue)</option>
                            <option value="one-dark">One Dark (mokai-one-dark)</option>
                            <option value="one-light">One Light (mokai-one-light)</option>
                        </select>
                    </div>
                </div>
                <!-- Demo editor-->
                <div id="editor" class="shadow-lg rounded-lg overflow-hidden flex"></div>
            </div>
            <!-- Footer section -->
            <div class="pb-16 pt-16 text-sm text-gray-700">
                Crafted with love by <a href="https://josemi.xyz" class="font-medium text-gray-900 hover:underline">Josemi</a>.
            </div>
        </div>
        <!-- Editor code -->
        <script type="module">
            import mokai from "./index.js";
            import mokaiHighlight from "./packages/mokai-syntax/index.js";

            const codes = {
                javascript: [
                    `import mokai from "mokai";`,
                    `import highlight from "mokai-syntax";`,
                    ``,
                    `// First get reference to the target element`,
                    `const target = document.getElementById("editor");`,
                    ``,            
                    `// Initialize codecake editor`,
                    `const editor = mokai(target, {`,
                    `    value: "",`,
                    `    className: "mokai-{theme}",`,
                    `    readOnly: false,`,
                    `    lineNumbers: true,`,
                    `    highlight: code => highlight(code, "javascript"),`,
                    `});`,
                    ``,
                    `// You can use the API methods to access the code`,
                    `editor.set("Hello world!");`,
                    ``,
                    `// Register events listeners`,
                    `editor.on("change", event => console.log("New code: ", event.value));`,
                ],
                html: [
                    `<html lang="en">`,
                    `<head>`,
                    `  <meta charset="utf-8">`,
                    `  <title>Mokai demo</title>`,
                    `</head>`,
                    `<body>`,
                    `    <h1>Mokai - Tiny code editor</h1>`,
                    `    <div class="description">`,
                    `        <b>Mokai</b> is a tiny code editor written in less than 200 lines of code!`,
                    `    </div>`,
                    `</body>`,
                    `</html>`,
                ],
                css: [
                    `@font-face {`,
                    `    font-family: Lato;`,
                    `    src: url("./lato.ttf");`,
                    `}`,
                    ``,
                    `html {`,
                    `    background-color: #fafafa;`,
                    `    margin: 0;`,
                    `    padding: 0;`,
                    `}`,
                    `/* Style body element */`,
                    `body {`,
                    `    border: 2px solid #000;`,
                    `    color: #333;`,
                    `    font-size: 16px;`,
                    `    font-family: "Lato", sans-serif;`,
                    `    margin: 0;`,
                    `    padding: 0;`,
                    `}`,
                    ``,
                    `a:visited,`,
                    `a:hover {`,
                    `    color: #444;`,
                    `    outline: none;`,
                    `    text-decoration: none;  `,
                    `}`,
                    ``,
                    `.link[data-active="true"] {`,
                    `    /* color: currentColor; */`,
                    `    color: gray;`,
                    `}`,
                ],
                markdown: [
                    `# Mokai`,
                    ``,
                    `> A tiny and lightweight code editor for web applications.`,
                    ``,
                    `## Features`,
                    ``,
                    `* Less than 200 lines of code. Easy to understand, customize, and integrate into your projects.`,
                    `* Automatically indents new lines.`,
                    `* Lightweight syntax highlighting with support for *JavaScript*, *HTML*, *CSS*, and *Markdown*.`,
                    ``,
                    `## Installation`,
                    ``,
                    `Install **mokai** in your project with just one command:`,
                    ``,
                    "```bash",
                    `npm install --save mokai`,
                    "```",
                ],
                json: [
                    `{`,
                    `   "name": "mokai",`,
                    `    "version": "1.0.0",`,
                    `    "description": "A tiny and lightweight code editor for web applications.",`,
                    `    "main": "mokai.js",`,
                    `    "scripts": {`,
                    `         "test": "echo 'Error: no test specified' && exit 1"`,
                    `    }`,
                    `}`,
                ],
            };
    
            const parent = document.getElementById("editor");
            const options = {
                theme: "dark",
                highlight: true,
                linenumbers: true,
                language: "javascript",
            };
            const reloadEditor = () => {
                // Remove parent childs
                while(parent.firstChild) {
                    parent.removeChild(parent.firstChild);
                }

                // Initialize the editor
                const editor = mokai(parent, {
                    value: codes[options.language].join("\n").replace("{theme}", options.theme),
                    className: `mokai-${options.theme} h-full`,
                    readOnly: false,
                    lineNumbers: options.linenumbers,
                    highlight: options.highlight && (code => mokaiHighlight(code, options.language)),
                });
                // editor.on("change", ({ value }) => {
                //     console.log("New code: ", value);
                // });
            };

            // Register listeners to language and theme
            ["language", "theme"].forEach(type => {
                document.querySelector(`select#select-${type}`).addEventListener("change", event => {
                    options[type] = event.target.value;
                    reloadEditor();
                });
            });

            // Init editor
            reloadEditor();
        </script>
    </body>
</html>
